(()=>{var w=Object.defineProperty;var y=(l,e,t)=>e in l?w(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var f=(l,e,t)=>(y(l,typeof e!="symbol"?e+"":e,t),t);var h=(l,e,t)=>new Promise((a,i)=>{var r=c=>{try{m(t.next(c))}catch(u){i(u)}},n=c=>{try{m(t.throw(c))}catch(u){i(u)}},m=c=>c.done?a(c.value):Promise.resolve(c.value).then(r,n);m((t=t.apply(l,e)).next())});var p=new Map,s=class extends HTMLElement{constructor(){super(),this.attrs={autoInitType:"autoinit",import:"import",template:"data-island",ready:"ready"},this.conditionMap={visible:d.visible,idle:d.idle,interaction:d.interaction,media:d.media,"save-data":d.saveData},this.ready=new Promise((e,t)=>{this.readyResolve=e,this.readyReject=t})}static getParents(e,t,a=!1){let i=[];for(;e;){if(e.matches&&e.matches(t)){if(a&&e===a)break;i.push(e)}e=e.parentNode}return i}static ready(e){return h(this,null,function*(){let t=s.getParents(e,s.tagName),a=yield Promise.all(t.map(i=>i.wait()));if(a.length)return a[0]})}forceFallback(){return h(this,null,function*(){let e=s.tagName+"--",t=[];window.Island&&Object.assign(s.fallback,window.Island.fallback);for(let a in s.fallback){let i=Array.from(this.querySelectorAll(a)).reverse();for(let r of i){if(!r.isConnected||r.localName===s.tagName)continue;let n=s.ready(r);t.push(s.fallback[a](n,r,e))}}return t})}wait(){return this.ready}getConditions(){let e={};for(let t of Object.keys(this.conditionMap))this.hasAttribute(`on:${t}`)&&(e[t]=this.getAttribute(`on:${t}`));return e}connectedCallback(){return h(this,null,function*(){yield this.forceFallback(),yield this.hydrate()})}getTemplates(){return this.querySelectorAll(`:scope template[${this.attrs.template}]`)}replaceTemplates(e){for(let t of e){if(s.getParents(t,s.tagName,this).length>0)continue;let a=t.getAttribute(this.attrs.template);if(a==="replace"){let i=Array.from(this.childNodes);for(let r of i)this.removeChild(r);this.appendChild(t.content);break}else{if(a==="once"&&t.innerHTML){if(p.has(t.innerHTML)){t.remove();return}p.set(t.innerHTML,!0)}t.replaceWith(t.content)}}}hydrate(){return h(this,null,function*(){let e=[];this.parentNode&&e.push(s.ready(this.parentNode));let t=this.getConditions();for(let r in t)this.conditionMap[r]&&e.push(this.conditionMap[r](t[r],this));yield Promise.all(e),this.replaceTemplates(this.getTemplates());let a,i=this.getAttribute(this.attrs.import);if(i&&(a=yield import(i)),a){let r=s.autoinit[this.getAttribute(this.attrs.autoInitType)||i];r&&(yield r.call(this,a))}this.readyResolve({import:a}),this.setAttribute(this.attrs.ready,"")})}},o=s;f(o,"tagName","is-land"),f(o,"fallback",{":not(:defined)":(e,t,a)=>{let i=document.createElement(a+t.localName);for(let n of t.getAttributeNames())i.setAttribute(n,t.getAttribute(n));let r=Array.from(t.childNodes);for(let n of r)i.append(n);return t.replaceWith(i),e.then(()=>{for(let n of Array.from(i.childNodes))t.append(n);i.replaceWith(t)})}}),f(o,"autoinit",{"petite-vue":function(e){e.createApp().mount(this)},vue:function(e){e.createApp().mount(this)},svelte:function(e){new e.default({target:this})},"svelte-ssr":function(e){new e.default({target:this,hydrate:!0})},preact:function(e){e.default(this)}});var d=class{static visible(e,t){if("IntersectionObserver"in window)return new Promise(a=>{let i=new IntersectionObserver(r=>{let[n]=r;n.isIntersecting&&(i.unobserve(n.target),a())});i.observe(t)})}static idle(){let e=new Promise(t=>{document.readyState!=="complete"?window.addEventListener("load",()=>t(),{once:!0}):t()});return"requestIdleCallback"in window?Promise.all([new Promise(t=>{requestIdleCallback(()=>{t()})}),e]):e}static interaction(e,t){let a=["click","touchstart"];return e&&(a=(e||"").split(",").map(i=>i.trim())),new Promise(i=>{function r(n){i();for(let m of a)t.removeEventListener(m,r)}for(let n of a)t.addEventListener(n,r,{once:!0})})}static media(e){let t={matches:!0};if(e&&"matchMedia"in window&&(t=window.matchMedia(e)),!t.matches)return new Promise(a=>{t.addListener(i=>{i.matches&&a()})})}static saveData(e){return!("connection"in navigator)||navigator.connection.saveData===(e!=="false")?Promise.resolve():new Promise(()=>{})}};"customElements"in window&&(window.customElements.define(o.tagName,o),window.Island=o);var g=o.ready;})();
